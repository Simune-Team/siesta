TBtrans Version: siesta-4.1--731
Architecture  : x86_64-linux-n-62-18-14
Compiler flags: mpifort -m64 -fPIC -O3 -march=native -ftree-vectorize -fexpensive-optimizatioons -funroll-loops -fprefetch-loop-arrays -fno-second-underscore  -flto -fuse-linker-plugin
PP flags      : -I/zdata/groups/common/nicpa/2016-oct/generic/build-tools/1.0/include -I/zdatta/groups/common/nicpa/2016-oct/generic/gmp/6.1.0/include -I/zdata/groups/common/nicpa/2016-oct/generic/mpfr/3.1.4/include -I/zdata/groups/common/nicpa/2016-oct/generic/mpc/1.0.3/include -I/zdata/groups/common/nicpa/2016-oct/generic/isl/0.16.1/include -I/zdata/groups/common/nicpa/2016-oct/generic/gcc/6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/generic/numactl/2.0.11/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/zlib/1.2.8/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/libxml2/2.9.4/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/hwloc/1.11.4/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/openmpi/2.0.1/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/hdf5/1.8.17/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/pnetcdf/1.7.0/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/netcdf/4.4.1/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/flook/0.7.0/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/parmetis/4.0.3/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/scalapack/204/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/openblas/0.2.19/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/mumps/5.0.2/gnu-6.2.0/include -I/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/fftw/3.3.5/gnu-6.2.0/include -DMPI -DFC_HAVE_FLUSH -DFC_HAVE_ABORT -DCDF -DCDF4 -DSIESTA__METIS -DSIESTA__MUMPS -DTS_NOCHECKS -DNCDF -DNCDF_4 -DNCDF_PARALLEL -DSIESTA__FLOOK  -DTBTRANS
Libraries     : -lnetcdff -lnetcdf -lpnetcdf -lhdf5_hl -lhdf5 -lz  -lzmumps -lmumps_common -llpord -lparmetis -lmetis -lscalapack -lopenblas  -lmetis -flto -fuse-linker-plugin  -L/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/flook/0.7.0/gnu-6.2.0/lib -Wl,-rpath=/zdata/groups/common/nicpa/2016-oct/XeonE5-2665/flook/0.7.0/gnu-6.2.0/lib -lflookall -ldl
PARALLEL version
NetCDF support
NetCDF-4 support
NetCDF-4 MPI-IO support
METIS ordering support

* Running on 8 nodes in parallel
>> Start of run:   2-JUL-2017  22:28:15

                           ************************ 
                           *  WELCOME TO TBtrans  * 
                           ************************ 

reinit: Reading from standard input
************************** Dump of input data file ****************************
SystemName  au_111_capacitor
SystemLabel au_111_capacitor
==================================================
==================================================
# SPECIES AND BASIS
# Number of species
NumberOfSpecies 1
%block ChemicalSpeciesLabel
  1  79 Au
%endblock ChemicalSpeciesLabel
PAO.BasisSize    SZP
PAO.EnergyShift  0.005 Ry
==================================================
==================================================
# K-points
%block kgrid_Monkhorst_Pack
8   0   0   0.0
0   8   0   0.0
0   0   30  0.5
%endblock kgrid_Monkhorst_Pack
==================================================
==================================================
# UNIT CELL
LatticeConstant       2.92311 Ang
%block LatticeVectors
1.000000000   0.00000000000   0.0000000000
0.500000000   0.86602540378   0.0000000000
0.000000000   0.00000000000  10.6144555530
%endblock LatticeVectors
# Atomic coordinates
NumberOfAtoms 10
AtomicCoordinatesFormat ScaledCartesian
%block AtomicCoordinatesAndAtomicSpecies
       0.000000000       0.000000000       0.000000000    1  # A
       0.500000000       0.288675135       0.816496581    1  # B
       0.500000000      -0.288675135       1.632993162    1  # C
       0.000000000       0.000000000       2.449489743    1  # A
       0.500000000       0.288675135       3.265986324    1  # B
       0.500000000       0.288675135       6.531972648    1  # B
       0.500000000      -0.288675135       7.348469229    1  # C
       0.000000000       0.000000000       8.164965810    1  # A
       0.500000000       0.288675135       8.981462391    1  # B
       0.500000000      -0.288675135       9.797958972    1  # C
%endblock AtomicCoordinatesAndAtomicSpecies
==================================================
==================================================
# General variables
ElectronicTemperature  100 K
MeshCutoff           350. Ry
xc.functional         LDA           # Exchange-correlation functional
xc.authors            CA
SpinPolarized .false.
SolutionMethod Transiesta
==================================================
==================================================
# SCF variables
DM.MixSCF1   T
MaxSCFIterations      300           # Maximum number of SCF iter
DM.MixingWeight       0.03          # New DM amount for next SCF cycle
DM.Tolerance          1.d-4         # Tolerance in maximum difference
DM.UseSaveDM          true          # to use continuation files
DM.NumberPulay         5
Diag.DivideAndConquer     no
MixHamiltonian yes
==================================================
==================================================
# MD variables
MD.FinalTimeStep 1
MD.TypeOfRun CG
MD.NumCGsteps     000
MD.UseSaveXV      .true.
==================================================
==================================================
# Output variables
WriteMullikenPop                1
WriteBands                      .false.
SaveRho                         .false.
SaveDeltaRho                    .false.
SaveHS                          .false.
SaveElectrostaticPotential      True
SaveTotalPotential              no
WriteCoorXmol                   .true.
WriteMDXmol                     .true.
WriteMDhistory                  .false.
WriteEigenvalues                yes
==================================================
==================================================
# Parallel variables
Diag.ParallelOverK      yes
==================================================
==================================================
# Transiesta information
TS.Voltage    1.00000 eV
%block TS.ChemPots
  Left
  Right
%endblock TS.ChemPots
%block TS.ChemPot.Left
  mu V/2
  contour.eq
    begin
      c-Left
      t-Left
    end
%endblock TS.ChemPot.Left
%block TS.ChemPot.Right
  mu -V/2
  contour.eq
    begin
      c-Right
      t-Right
    end
%endblock TS.ChemPot.Right
TS.Elecs.Bulk true
TS.Elecs.DM.Update none
# This is for testing purposes!
# DO NOT USE IF YOU DO NOT UNDERSTAND!
TS.Elecs.Neglect.Principal true
TS.Elecs.GF.ReUse true
%block TS.Elecs
  Left
  Right
%endblock TS.Elecs
%block TS.Elec.Left
  TSHS ./elec_au_111_abc.TSHS
  chem-pot Left
  semi-inf-dir -a3
  elec-pos begin 1
%endblock TS.Elec.Left
%block TS.Elec.Right
  TSHS ./elec_au_111_abc.TSHS
  chem-pot Right
  semi-inf-dir +a3
  elec-pos end -1
%endblock TS.Elec.Right
TS.Contours.Eq.Pole    2.50000 eV
%block TS.Contour.c-Left
  part circle
   from  -40.00000 eV + V/2 to -10. kT + V/2
    points 30
     method g-legendre
%endblock TS.Contour.c-Left
%block TS.Contour.t-Left
  part tail
   from prev to inf
    points 10
     method g-fermi
%endblock TS.Contour.t-Left
%block TS.Contour.c-Right
  part circle
   from  -40.00000 eV - V/2 to -10. kT - V/2
    points 30
     method g-legendre
%endblock TS.Contour.c-Right
%block TS.Contour.t-Right
  part tail
   from prev to inf
    points 10
     method g-fermi
%endblock TS.Contour.t-Right
TS.Elecs.Eta    0.0001 eV
%block TS.Contours.nEq
  neq
%endblock TS.Contours.nEq
%block TS.Contour.nEq.neq
  part line
   from -|V|/2 - 5 kT to |V|/2 + 5 kT
    delta    0.01 eV
     method mid-rule
%endblock TS.Contour.nEq.neq
# TBtrans options
TBT.Elecs.Eta    0.0001 eV
%block TBT.Contours
  neq
%endblock TBT.Contours
%block TBT.Contour.neq
  part line
   from   -0.50000 eV to    0.50000 eV
    delta    0.01000 eV
     method mid-rule
%endblock TBT.Contour.neq
TBT.T.Eig 3
************************** End of input data file *****************************

reinit: -----------------------------------------------------------------------
reinit: System Name: au_111_capacitor
reinit: -----------------------------------------------------------------------
reinit: System Label: au_111_capacitor
reinit: -----------------------------------------------------------------------

k-point displ. along   1 input, could be:     0.00    0.50
k-point displ. along   2 input, could be:     0.00    0.50
 Kpoints in:           40 . Kpoints trimmed:           34
tbt: Number of transport k-points = 34
tbt: Method = Monkhorst-Pack grid.
tbt: k-grid: Supercell and displacements
tbt:            8   0   0      0.000
tbt:            0   8   0      0.000
tbt:            0   0   1      0.000

tbt: **************************************************************
tbt: Electronic temperature (reference)             =   99.9993 K
tbt: Voltage                                        =    1.0000 Volts
tbt: Calculate transmission only using diag(Gf)     =    F
tbt: Saving bulk transmission for electrodes        =    F
tbt: Saving DOS from bulk electrodes                =    F
tbt: Saving DOS from Green function                 =    F
tbt: Saving DOS from spectral functions             =    F
tbt: Saving bond currents (orb-orb)                 =    F
tbt: Calc. # transmission eigenvalues               =  3
tbt: Calc. T between all electrodes                 =    F
tbt: Calc. total T out of electrodes                =    F
tbt: Single spin Hamiltonian
tbt: BTD creation algorithm                         =    speed
tbt: BTD spectral function algorithm                =    propagation
tbt: Divide and conquer diagonalization             =    F
tbt: Assume LAPACK <i|S|j> = delta_ij               =    F
tbt: Saving down-folded self-energies               =    F
tbt: No delta-Hamiltonian
tbt: Data files stored in current folder
tbt: No compression of TBT.nc files
tbt: Default NetCDF precision                       =    single
tbt: Use parallel MPI-IO for NetCDF file            =    F
tbt:           >> Electrodes << 
tbt: >> Left
tbt:   Electrode cell pivoting: E1, E2, E3          = A1, A2, A3
tbt:   In-core GF
tbt:   Electrode TSHS file                          = ./elec_au_111_abc.TSHS
tbt:   # atoms used in electrode                    =    3
tbt:   Electrode Bloch expansion [E1 x E2 x E3]     = 1 x 1 x 1
tbt:   Position in geometry                         = 1 -- 3
tbt:   Semi-infinite direction for electrode        = negative wrt. E3
tbt:   Chemical shift                               =    0.499999 eV
tbt:   Electronic temperature                       =   99.999269 K
tbt:   Bulk values in electrode                     =    T
tbt:   Hamiltonian E-C Ef fractional shift          =    0.0000
tbt:   Electrode self-energy imaginary Eta          =  0.1000E-03  eV
tbt:   Electrode self-energy accuracy               =  0.1000E-13  eV
tbt:   Electrode inter-layer distance (semi-inf)    =    2.3867  Ang
tbt: >> Right
tbt:   Electrode cell pivoting: E1, E2, E3          = A1, A2, A3
tbt:   In-core GF
tbt:   Electrode TSHS file                          = ./elec_au_111_abc.TSHS
tbt:   # atoms used in electrode                    =    3
tbt:   Electrode Bloch expansion [E1 x E2 x E3]     = 1 x 1 x 1
tbt:   Position in geometry                         = 8 -- 10
tbt:   Semi-infinite direction for electrode        = positive wrt. E3
tbt:   Chemical shift                               =   -0.499999 eV
tbt:   Electronic temperature                       =   99.999269 K
tbt:   Bulk values in electrode                     =    T
tbt:   Hamiltonian E-C Ef fractional shift          =    0.0000
tbt:   Electrode self-energy imaginary Eta          =  0.1000E-03  eV
tbt:   Electrode self-energy accuracy               =  0.1000E-13  eV
tbt:   Electrode inter-layer distance (semi-inf)    =    2.3867  Ang
ts:              >> TBtrans contour << 
ts: Device Green function imaginary Eta             =  0.000     eV
ts: Contour name                                    =    TBT.Contour.neq
ts:   line contour E_min                            =   -0.5000 eV
ts:   line contour E_max                            =    0.5000 eV
ts:   line contour points                           =  100
ts:   line contour method                           =    Mid-rule
tbt: **************************************************************

tbt: <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
%block TBT.Contours
    neq
%endblock TBT.Contours

%block TBT.Contour.neq
     from -0.50000 eV to 0.50000 eV
      delta 0.01000 eV
        method mid-rule
%endblock TBT.Contour.neq
tbt: <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

************************ Begin: TBT CHECKS AND WARNINGS ************************
 ** Use TBT.Atoms.Device for faster execution
 ** Speed up the execution by utilizing parallel I/O
  > TBT.CDF.MPI true
************************ End: TBT CHECKS AND WARNINGS **************************

Device information (full):
  <sparsity:au_111_capacitor.TSHS
    nrows_g=90 nrows=90 sparsity=11.5346 nnzs=93430, refcount: 3>

Electrode information:

  <sparsity:./elec_au_111_abc.TSHS
    nrows_g=27 nrows=27 sparsity=44.2757 nnzs=32277, refcount: 3>
  <sparsity:(TM [--,--, 0] of: ./elec_au_111_abc.TSHS)
    nrows_g=27 nrows=27 sparsity=25.1152 nnzs=18309, refcount: 3>
  <sparsity:(TM [--,--,-1] of: ./elec_au_111_abc.TSHS)
    nrows_g=27 nrows=27 sparsity=9.4486 nnzs=6888, refcount: 3>
 Left principal cell is extending out with 96 elements:
    Atom 1 connects with atom 3
    Orbital 8 connects with orbital 26
    Hamiltonian value: |H(8,6587)|@R=-2 =  0.651E-13 eV
    Overlap          :  S(8,6587)|@R=-2 =   0.00    

  <sparsity:./elec_au_111_abc.TSHS
    nrows_g=27 nrows=27 sparsity=44.2757 nnzs=32277, refcount: 3>
  <sparsity:(TM [--,--, 0] of: ./elec_au_111_abc.TSHS)
    nrows_g=27 nrows=27 sparsity=25.1152 nnzs=18309, refcount: 3>
  <sparsity:(TM [--,--, 1] of: ./elec_au_111_abc.TSHS)
    nrows_g=27 nrows=27 sparsity=9.4486 nnzs=6888, refcount: 3>
 Right principal cell is extending out with 96 elements:
    Atom 3 connects with atom 1
    Orbital 26 connects with orbital 8
    Hamiltonian value: |H(26,4382)|@R=2 =  0.651E-13 eV
    Overlap          :  S(26,4382)|@R=2 =   0.00    


tbtrans: Analyzing electrode sparsity pattern to create optimal tri-diagonal blocks
tbtrans: BTD pivoting scheme for electrode (Left): atom+Left

tbtrans: Analyzing device sparsity pattern to create optimal tri-diagonal blocks

WARNING: Random atom 6 has been added due to non-completeness of the connectivity graph.
WARNING: Expect sub-optimal BTD format.
tbtrans: BTD pivoting scheme in device: atom+Left
tbtrans: Done analyzing sparsity pattern

tbtrans: Reducing matrix (H, S) sparsity patterns by: 14160

tbtrans: # of device region orbitals: 36
Region (4): [A]-device
  [ 4 -- 7 ]

tbtrans: # of Left scattering orbitals: 18
tbtrans: # of Left down-folding orbitals: 45
Region (3): [A]-Left folding region
  [ 1 -- 3 ]
Region (2): [A]-Left folding in D
  [ 4 -- 5 ]

tbtrans: # of Right scattering orbitals: 18
tbtrans: # of Right down-folding orbitals: 45
Region (3): [A]-Right folding region
  [ 8 -- 10 ]
Region (2): [A]-Right folding in D
  [ 6 -- 7 ]

tbtrans: Creating electrode tri-diagonal matrix blocks
tbtrans: Creating device tri-diagonal matrix blocks
Region (2): [TRI] device region
  [ 18, 18 ]
tbtrans: Matrix elements in BTD: 1296

tbtrans: Electrodes tri-diagonal matrices
Region (2): [TRI] Left
  [ 27, 18 ]
Region (2): [TRI] Right
  [ 27, 18 ]

tbtrans: Electrode memory:    0.791 MB
tbtrans: Sparse Hamiltonian and overlap memory:    0.670 MB
tbtrans: Sum of electrode and sparse memory:    1.461 MB

tbtrans: Initializing data file: au_111_capacitor.TBT.nc
tbtrans: LHS Green function size / memory: 8748 /     0.13 MB
tbtrans: RHS Green function size / memory: 1620 /     0.02 MB
tbt: Initial ETA in               13.566 s
tbt: Calculated   5.059 %, ETA in                4.710 s
tbt: Calculated  10.235 %, ETA in                4.174 s
tbt: Calculated  15.412 %, ETA in                3.578 s
tbt: Calculated  20.471 %, ETA in                3.352 s
tbt: Calculated  25.647 %, ETA in                3.206 s
tbt: Calculated  30.824 %, ETA in                3.023 s
tbt: Calculated  36.000 %, ETA in                2.810 s
tbt: Calculated  41.059 %, ETA in                2.470 s
tbt: Calculated  46.235 %, ETA in                2.243 s
tbt: Calculated  51.412 %, ETA in                2.053 s
tbt: Calculated  56.588 %, ETA in                1.853 s
tbt: Calculated  61.647 %, ETA in                1.628 s
tbt: Calculated  66.824 %, ETA in                1.355 s
tbt: Calculated  72.000 %, ETA in                1.136 s
tbt: Calculated  77.176 %, ETA in                0.936 s
tbt: Calculated  82.235 %, ETA in                0.733 s
tbt: Calculated  87.412 %, ETA in                0.516 s
tbt: Calculated  92.588 %, ETA in                0.302 s
tbt: Calculated  97.765 %, ETA in                0.091 s
tbt: Completed in                4.068 s

Currents (ensure entire Fermi function window):
Left -> Right, V [V] / I [A]: 0.999999     V /  0.00000     A
Left -> Right, V [V] / P [W]: 0.999999     V /  0.00000     W


             Section          Calls    Walltime       %
 global_section                   1       4.468  100.00
  tbtrans                         1       4.468  100.00
   tri-init                       1       0.043    0.95
    tri-init-elec                 1       0.002    0.05
     TS-rgn2tri                   1       0.000    0.01
    TS-rgn2tri                    1       0.037    0.84
   TBT                            1       4.184   93.63
    read-GS                     442       3.482   77.93
    SE-dwn                      442       0.076    1.71
     ts_expand                  816       0.002    0.05
    Gf-prep                     442       0.047    1.06
     V_TM_Pinv                  408       0.035    0.78
    DOS-Gf-A-T                  442       0.030    0.68
    cdf2ascii                     1       0.036    0.81
>> End of run:   2-JUL-2017  22:28:19
